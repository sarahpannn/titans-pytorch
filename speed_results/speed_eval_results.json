{
  "model": "meta-llama/Meta-Llama-3.1-8B",
  "prompt": "In a distant future, an explorer finds",
  "batch_size": 1,
  "prompt_length": 512,
  "gen_lengths": [
    16,
    32,
    64,
    128,
    256,
    512,
    1024
  ],
  "nmm_batch_size": 64,
  "nmm_chunk_size": 64,
  "dtype": "bfloat16",
  "device": "cuda",
  "segment_len": 512,
  "num_persist": 0,
  "num_longterm": 4,
  "warmup_steps": 3,
  "results": [
    {
      "variant": "segmented_with_nmm",
      "prompt_length": 1017,
      "gen_len": 16,
      "num_trials": 5,
      "tokens_per_sec": 13.005654967371953,
      "avg_elapsed": 1.23023408203125,
      "avg_new_tokens": 16,
      "peak_mem_bytes": 28670799872,
      "peak_mem_gib": 26.701763153076172
    },
    {
      "variant": "segmented_with_nmm",
      "prompt_length": 1017,
      "gen_len": 32,
      "num_trials": 5,
      "tokens_per_sec": 15.237146813569105,
      "avg_elapsed": 2.1001307128906253,
      "avg_new_tokens": 32,
      "peak_mem_bytes": 28670808576,
      "peak_mem_gib": 26.70177125930786
    },
    {
      "variant": "segmented_with_nmm",
      "prompt_length": 1017,
      "gen_len": 64,
      "num_trials": 5,
      "tokens_per_sec": 16.526886919411325,
      "avg_elapsed": 3.87247763671875,
      "avg_new_tokens": 64,
      "peak_mem_bytes": 28670808576,
      "peak_mem_gib": 26.70177125930786
    },
    {
      "variant": "segmented_with_nmm",
      "prompt_length": 1017,
      "gen_len": 128,
      "num_trials": 5,
      "tokens_per_sec": 17.511172036109684,
      "avg_elapsed": 7.30961923828125,
      "avg_new_tokens": 128,
      "peak_mem_bytes": 28670177280,
      "peak_mem_gib": 26.701183319091797
    },
    {
      "variant": "segmented_with_nmm",
      "prompt_length": 1017,
      "gen_len": 256,
      "num_trials": 5,
      "tokens_per_sec": 17.694739128012994,
      "avg_elapsed": 14.467576953125,
      "avg_new_tokens": 256,
      "peak_mem_bytes": 28670152704,
      "peak_mem_gib": 26.701160430908203
    },
    {
      "variant": "segmented_with_nmm",
      "prompt_length": 1017,
      "gen_len": 512,
      "num_trials": 5,
      "tokens_per_sec": 18.223214608591494,
      "avg_elapsed": 28.096030859375002,
      "avg_new_tokens": 512,
      "peak_mem_bytes": 28670152704,
      "peak_mem_gib": 26.701160430908203
    },
    {
      "variant": "segmented_with_nmm",
      "prompt_length": 1017,
      "gen_len": 1024,
      "num_trials": 5,
      "tokens_per_sec": 18.52049776776795,
      "avg_elapsed": 55.29009062499999,
      "avg_new_tokens": 1024,
      "peak_mem_bytes": 28671168512,
      "peak_mem_gib": 26.702106475830078
    },
    {
      "variant": "segmented_no_nmm",
      "prompt_length": 1017,
      "gen_len": 16,
      "num_trials": 5,
      "tokens_per_sec": 19.34036705795084,
      "avg_elapsed": 0.8272852294921874,
      "avg_new_tokens": 16,
      "peak_mem_bytes": 19515067392,
      "peak_mem_gib": 18.17482280731201
    },
    {
      "variant": "segmented_no_nmm",
      "prompt_length": 1017,
      "gen_len": 32,
      "num_trials": 5,
      "tokens_per_sec": 20.81025054717962,
      "avg_elapsed": 1.5377037353515626,
      "avg_new_tokens": 32,
      "peak_mem_bytes": 19515067392,
      "peak_mem_gib": 18.17482280731201
    },
    {
      "variant": "segmented_no_nmm",
      "prompt_length": 1017,
      "gen_len": 64,
      "num_trials": 5,
      "tokens_per_sec": 21.43990052639902,
      "avg_elapsed": 2.9850884765625003,
      "avg_new_tokens": 64,
      "peak_mem_bytes": 19515067392,
      "peak_mem_gib": 18.17482280731201
    },
    {
      "variant": "segmented_no_nmm",
      "prompt_length": 1017,
      "gen_len": 128,
      "num_trials": 5,
      "tokens_per_sec": 21.470456303545916,
      "avg_elapsed": 5.96168046875,
      "avg_new_tokens": 128,
      "peak_mem_bytes": 19515067904,
      "peak_mem_gib": 18.17482328414917
    },
    {
      "variant": "segmented_no_nmm",
      "prompt_length": 1017,
      "gen_len": 256,
      "num_trials": 5,
      "tokens_per_sec": 22.120079467033534,
      "avg_elapsed": 11.573195312500001,
      "avg_new_tokens": 256,
      "peak_mem_bytes": 19515068928,
      "peak_mem_gib": 18.174824237823486
    },
    {
      "variant": "segmented_no_nmm",
      "prompt_length": 1017,
      "gen_len": 512,
      "num_trials": 5,
      "tokens_per_sec": 22.020044032696084,
      "avg_elapsed": 23.251542968749998,
      "avg_new_tokens": 512,
      "peak_mem_bytes": 19515070976,
      "peak_mem_gib": 18.17482614517212
    },
    {
      "variant": "segmented_no_nmm",
      "prompt_length": 1017,
      "gen_len": 1024,
      "num_trials": 5,
      "tokens_per_sec": 21.958006083985318,
      "avg_elapsed": 46.63447109375001,
      "avg_new_tokens": 1024,
      "peak_mem_bytes": 19585381888,
      "peak_mem_gib": 18.24030828475952
    },
    {
      "variant": "base_llama",
      "prompt_length": 1017,
      "gen_len": 16,
      "num_trials": 5,
      "tokens_per_sec": 30.2757872629787,
      "avg_elapsed": 0.5284751098632813,
      "avg_new_tokens": 16,
      "peak_mem_bytes": 16923620352,
      "peak_mem_gib": 15.76134967803955
    },
    {
      "variant": "base_llama",
      "prompt_length": 1017,
      "gen_len": 32,
      "num_trials": 5,
      "tokens_per_sec": 29.932440769349043,
      "avg_elapsed": 1.0690741943359376,
      "avg_new_tokens": 32,
      "peak_mem_bytes": 16925529088,
      "peak_mem_gib": 15.763127326965332
    },
    {
      "variant": "base_llama",
      "prompt_length": 1017,
      "gen_len": 64,
      "num_trials": 5,
      "tokens_per_sec": 29.57338332325345,
      "avg_elapsed": 2.164108154296875,
      "avg_new_tokens": 64,
      "peak_mem_bytes": 16929346560,
      "peak_mem_gib": 15.766682624816895
    },
    {
      "variant": "base_llama",
      "prompt_length": 1017,
      "gen_len": 128,
      "num_trials": 5,
      "tokens_per_sec": 28.62592773224327,
      "avg_elapsed": 4.471470800781249,
      "avg_new_tokens": 128,
      "peak_mem_bytes": 16936984576,
      "peak_mem_gib": 15.773796081542969
    },
    {
      "variant": "base_llama",
      "prompt_length": 1017,
      "gen_len": 256,
      "num_trials": 5,
      "tokens_per_sec": 27.099836200147774,
      "avg_elapsed": 9.4465515625,
      "avg_new_tokens": 256,
      "peak_mem_bytes": 16952260608,
      "peak_mem_gib": 15.788022994995117
    },
    {
      "variant": "base_llama",
      "prompt_length": 1017,
      "gen_len": 512,
      "num_trials": 5,
      "tokens_per_sec": 24.51737772399305,
      "avg_elapsed": 20.883146874999998,
      "avg_new_tokens": 512,
      "peak_mem_bytes": 16983238656,
      "peak_mem_gib": 15.816873550415039
    },
    {
      "variant": "base_llama",
      "prompt_length": 1017,
      "gen_len": 1024,
      "num_trials": 5,
      "tokens_per_sec": 20.68000733721208,
      "avg_elapsed": 49.516423437499995,
      "avg_new_tokens": 1024,
      "peak_mem_bytes": 17044375552,
      "peak_mem_gib": 15.873811721801758
    }
  ]
}